CREATE FUNCTION PadOrTrim(IN val ANY, IN targetLen INTEGER) RETURNS CHARACTER
BEGIN
    DECLARE strVal CHARACTER;
    DECLARE outVal CHARACTER;
    DECLARE padLen INTEGER;

    -- Convert integer to string if needed
    IF TYPEOF(val) = INTEGER THEN
        SET strVal = CAST(val AS CHARACTER);
    ELSE
        SET strVal = val;
    END IF;

    -- Calculate padding length
    SET padLen = targetLen - LENGTH(strVal);

    IF padLen > 0 THEN
        -- Add spaces to the right until reaching targetLen
        SET outVal = strVal || RPAD('', padLen, ' ');
    ELSEIF padLen < 0 THEN
        -- Truncate if too long
        SET outVal = SUBSTRING(strVal FROM 1 FOR targetLen);
    ELSE
        -- Exact length
        SET outVal = strVal;
    END IF;

    RETURN outVal;
END;
