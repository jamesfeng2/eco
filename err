-- Copy the count
SET OutputRoot.DFDL.SOM_GENPDF_REQ_MSG.ISIS_Header.ISIS_Insert_Cnt = ref2.ISIS_Insert_Cnt;

-- Loop through each detail
DECLARE inCNT INTEGER COALESCE(ref2.ISIS_Insert_Cnt, 0);
DECLARE i INTEGER 1;

WHILE i <= inCNT DO
    -- Create reference to input detail
    DECLARE refDtl REFERENCE TO ref2.ISIS_Insert_Dtl[i];

    -- Create target element in output
    CREATE LASTCHILD OF OutputRoot.DFDL.SOM_GENPDF_REQ_MSG.ISIS_Header NAME 'ISIS_Insert_Dtl';
    DECLARE outDtl REFERENCE TO OutputRoot.DFDL.SOM_GENPDF_REQ_MSG.ISIS_Header.ISIS_Insert_Dtl[i];

    -- Set each field with padding/trimming
    SET outDtl.insertCode = PadOrTrim(refDtl.insertCode, 10);
    SET outDtl.insertName = PadOrTrim(refDtl.insertName, 50);

    SET i = i + 1;
END WHILE;
